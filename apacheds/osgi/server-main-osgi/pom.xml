<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <parent>
    <groupId>org.apache.directory.server</groupId>
    <artifactId>build</artifactId>
    <version>1.1.0-SNAPSHOT</version>
  </parent>
  <artifactId>apacheds-server-main-osgi</artifactId>
  <name>ApacheDS OSGi Server Main</name>
  <packaging>pom</packaging>
  <build>
    <plugins>
      <plugin>
        <artifactId>maven-resources-plugin</artifactId>
        <executions>
          <execution>
            <phase>generate-resources</phase>
            <goals>
              <goal>resources</goal>
            </goals>
            <configuration>
              <outputDirectory>${basedir}/target/generated-resources</outputDirectory>
            </configuration>
          </execution>
        </executions>
      </plugin>
      <plugin>
        <artifactId>maven-antrun-plugin</artifactId>
        <version>1.1</version>
        <executions>
          <execution>
            <phase>package</phase>
            <goals>
              <goal>run</goal>
            </goals>
            <configuration>
              <tasks>
                <delete dir="${user.home}/.felix/apacheds"/>
                <delete dir="${basedir}/bin"/>
                <mkdir dir="${basedir}/bin"/>
                <delete dir="${basedir}/lib"/>
                <mkdir dir="${basedir}/lib"/>
                <delete dir="${basedir}/conf"/>
                <mkdir dir="${basedir}/conf"/>
                <delete dir="${basedir}/bundle"/>
                <mkdir dir="${basedir}/bundle"/>
                <copy file="${basedir}/target/generated-resources/config.properties" todir="${basedir}/conf"/>
                <copy file="${basedir}/target/generated-resources/log4j.properties" todir="${basedir}/conf"/>
              </tasks>
            </configuration>
          </execution>
        </executions>
      </plugin>
      <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>dependency-maven-plugin</artifactId>
        <executions>
          <execution>
            <phase>install</phase>
            <goals>
              <goal>copy</goal>
            </goals>
            <configuration>
              <artifactItems>
                <artifactItem>
                  <groupId>org.apache.felix</groupId>
                  <artifactId>org.apache.felix.main</artifactId>
                  <version>0.8.0-SNAPSHOT</version>
                  <type>jar</type>
                  <outputDirectory>${basedir}/bin</outputDirectory>
                  <destFileName>felix.jar</destFileName>
                </artifactItem>
                <artifactItem>
                  <groupId>org.apache.felix</groupId>
                  <artifactId>org.apache.felix.framework</artifactId>
                  <version>0.8.0-SNAPSHOT</version>
                  <type>jar</type>
                  <outputDirectory>${basedir}/lib</outputDirectory>
                </artifactItem>
                <artifactItem>
                  <groupId>org.apache.felix</groupId>
                  <artifactId>org.osgi.core</artifactId>
                  <version>0.8.0-SNAPSHOT</version>
                  <type>jar</type>
                  <outputDirectory>${basedir}/lib</outputDirectory>
                </artifactItem>
                <artifactItem>
                  <groupId>org.apache.felix</groupId>
                  <artifactId>org.osgi.compendium</artifactId>
                  <version>0.8.0-SNAPSHOT</version>
                  <type>jar</type>
                  <outputDirectory>${basedir}/bundle</outputDirectory>
                </artifactItem>
                <artifactItem>
                  <groupId>org.apache.felix</groupId>
                  <artifactId>org.apache.felix.shell</artifactId>
                  <version>0.8.0-SNAPSHOT</version>
                  <type>jar</type>
                  <outputDirectory>${basedir}/bundle</outputDirectory>
                </artifactItem>
                <artifactItem>
                  <groupId>org.apache.felix</groupId>
                  <artifactId>org.apache.felix.shell.tui</artifactId>
                  <version>0.8.0-SNAPSHOT</version>
                  <type>jar</type>
                  <outputDirectory>${basedir}/bundle</outputDirectory>
                </artifactItem>
                <artifactItem>
                  <groupId>org.apache.felix</groupId>
                  <artifactId>org.apache.felix.bundlerepository</artifactId>
                  <version>0.8.0-SNAPSHOT</version>
                  <type>jar</type>
                  <outputDirectory>${basedir}/bundle</outputDirectory>
                </artifactItem>
                <artifactItem>
                  <groupId>org.apache.directory.server</groupId>
                  <artifactId>mina-core-osgi</artifactId>
                  <version>${pom.version}</version>
                  <type>jar</type>
                  <outputDirectory>${basedir}/bundle</outputDirectory>
                </artifactItem>
                <artifactItem>
                  <groupId>org.apache.directory.server</groupId>
                  <artifactId>mina-filter-codec-asn1-osgi</artifactId>
                  <version>${pom.version}</version>
                  <type>jar</type>
                  <outputDirectory>${basedir}/bundle</outputDirectory>
                </artifactItem>
                <artifactItem>
                  <groupId>org.apache.directory.server</groupId>
                  <artifactId>apacheds-protocol-ntp-osgi</artifactId>
                  <version>${pom.version}</version>
                  <type>jar</type>
                  <outputDirectory>${basedir}/bundle</outputDirectory>
                </artifactItem>
                <artifactItem>
                  <groupId>org.apache.directory.server</groupId>
                  <artifactId>apacheds-protocol-ldap-osgi</artifactId>
                  <version>${pom.version}</version>
                  <type>jar</type>
                  <outputDirectory>${basedir}/bundle</outputDirectory>
                </artifactItem>
                <artifactItem>
                  <groupId>org.apache.directory.server</groupId>
                  <artifactId>apacheds-protocol-dns-osgi</artifactId>
                  <version>${pom.version}</version>
                  <type>jar</type>
                  <outputDirectory>${basedir}/bundle</outputDirectory>
                </artifactItem>
                <artifactItem>
                  <groupId>org.apache.directory.server</groupId>
                  <artifactId>apacheds-protocol-kerberos-osgi</artifactId>
                  <version>${pom.version}</version>
                  <type>jar</type>
                  <outputDirectory>${basedir}/bundle</outputDirectory>
                </artifactItem>
                <artifactItem>
                  <groupId>org.apache.directory.server</groupId>
                  <artifactId>apacheds-protocol-changepw-osgi</artifactId>
                  <version>${pom.version}</version>
                  <type>jar</type>
                  <outputDirectory>${basedir}/bundle</outputDirectory>
                </artifactItem>
                <artifactItem>
                  <groupId>org.apache.directory.server</groupId>
                  <artifactId>apacheds-server-logger-osgi</artifactId>
                  <version>${pom.version}</version>
                  <type>jar</type>
                  <outputDirectory>${basedir}/bundle</outputDirectory>
                </artifactItem>
                <artifactItem>
                  <groupId>org.apache.directory.server</groupId>
                  <artifactId>apacheds-server-loader-osgi</artifactId>
                  <version>${pom.version}</version>
                  <type>jar</type>
                  <outputDirectory>${basedir}/bundle</outputDirectory>
                </artifactItem>
                <artifactItem>
                  <groupId>org.apache.directory.server</groupId>
                  <artifactId>apacheds-core-osgi</artifactId>
                  <version>${pom.version}</version>
                  <type>jar</type>
                  <outputDirectory>${basedir}/bundle</outputDirectory>
                </artifactItem>
                <artifactItem>
                  <groupId>org.apache.directory.server</groupId>
                  <artifactId>shared-ldap-osgi</artifactId>
                  <version>${pom.version}</version>
                  <type>jar</type>
                  <outputDirectory>${basedir}/bundle</outputDirectory>
                </artifactItem>
                <artifactItem>
                  <groupId>org.apache.directory.server</groupId>
                  <artifactId>shared-asn1-osgi</artifactId>
                  <version>${pom.version}</version>
                  <type>jar</type>
                  <outputDirectory>${basedir}/bundle</outputDirectory>
                </artifactItem>
                <artifactItem>
                  <groupId>org.apache.directory.server</groupId>
                  <artifactId>antlr-osgi</artifactId>
                  <version>${pom.version}</version>
                  <type>jar</type>
                  <outputDirectory>${basedir}/bundle</outputDirectory>
                </artifactItem>
                <artifactItem>
                  <groupId>org.apache.directory.server</groupId>
                  <artifactId>commons-lang-osgi</artifactId>
                  <version>${pom.version}</version>
                  <type>jar</type>
                  <outputDirectory>${basedir}/bundle</outputDirectory>
                </artifactItem>
                <artifactItem>
                  <groupId>org.apache.directory.server</groupId>
                  <artifactId>commons-collections-osgi</artifactId>
                  <version>${pom.version}</version>
                  <type>jar</type>
                  <outputDirectory>${basedir}/bundle</outputDirectory>
                </artifactItem>
                <artifactItem>
                  <groupId>org.apache.felix</groupId>
                  <artifactId>org.apache.felix.servicebinder</artifactId>
                  <version>0.8.0-SNAPSHOT</version>
                  <type>jar</type>
                  <outputDirectory>${basedir}/bundle</outputDirectory>
                </artifactItem>
              </artifactItems>
              <outputDirectory>${project.build.directory}/lib</outputDirectory>
            </configuration>
          </execution>
        </executions>
      </plugin>
    </plugins>
    <resources>
      <resource>
        <directory>src/main/resources</directory>
        <filtering>true</filtering>
      </resource>
    </resources>
  </build>
</project>
